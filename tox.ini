[tox]
envlist = py{310,311,312}
minversion = 3.9

[testenv]
deps = -rrequirements_dev.txt


[testenv:py{310,311,312}-unit]
description = Run unit-tests
usedevelop = True
deps = {[testenv]deps}
commands =
    pytest  -vv tests/unit {posargs}


[testenv:py{310,311,312}-acceptance]
description = Run acceptance-tests
usedevelop = True
deps =
    {[testenv]deps}
    deepdiff
commands =
    pytest  -vv -s tests/acceptance {posargs}


[testenv:py{310,311,312}-lint]
description = Run pylint to determine code-quality
usedevelop = True
deps = pylint
commands =
    - pylint tests/unit --disable=missing-docstring
    - pylint tests/acceptance --disable=missing-docstring
    - pylint logprep


[testenv:py{310,311,312}-docs]
description = Build sphinx HTML documentation
changedir = doc
usedevelop = True
allowlist_externals = make
deps =
    {[testenv]deps}
    -r doc/requirements.txt
commands =
    sphinx-apidoc -fT -o source/module_reference ../logprep
    make clean html

[testenv:py{310,311,312}-all]
description = Run all tests with coverage and lint
usedevelop = True
deps =
    {[testenv]deps}
    deepdiff
commands =
    - pylint logprep
    pytest  -vv tests --cov=logprep --cov-report=term --cov-report=html --cov-report=xml {posargs}
